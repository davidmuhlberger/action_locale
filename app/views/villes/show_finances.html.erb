<div class="container">
  <div class="row">
    <div class="col-md-1 col-sm-12">
    </div>
    <div class="col-md-11 col-sm-12">
      <br>
      <div class="entity-title">
        <h2>
          <strong><%= @ville[:nom_propre].mb_chars.upcase%></strong>
        </h2>
      </div>
      <div class="text-center">
        <%= image_tag "town_illustration.png" %>
      </div>
      <br>
      <ul class="nav nav-tabs">
        <li role="presentation">
          <%= link_to "Chiffres clés", ville_indicateurs_path(nom_propre_et_dep: @ville.nom_propre_et_dep) %>
        </li>
        <li role="presentation">
          <%= link_to "Fiscalité", ville_fiscalite_path(nom_propre_et_dep: @ville.nom_propre_et_dep) %>
        </li>
        <li role="presentation" >
          <%= link_to "Dépenses", ville_depenses_path(nom_propre_et_dep: @ville.nom_propre_et_dep) %>
        </li>
        <li role="presentation" class="active" >
          <%= link_to "Finances", ville_finances_path(nom_propre_et_dep: @ville.nom_propre_et_dep) %>
        </li>
      </ul>
      <br>
      <div class="card">
        <div class="card-title">
          <br>
          <h4><strong>Situation financière de la commune</strong></h4>
          <br>
          <% if @comptes_2016[:population] < 1000 %>
            <p>
              Attention, <%= @ville[:nom_propre] %> est une petite commune,
              de moins de 1000 habitants. Ses ratios financiers peuvent être très sensibles
              à des variations ponctuelles de certains comptes ou à des investissements qui
              vont augmenter sa dette mais ne présentent pas de risques si leur remboursement
              est correctement anticipé.
            </p>
          <% else %>
          <div class="card-tab">
            <table class="table">
              <thead>
                <tr>
                  <th class="text-center">
                    Capacité d'autofinancement
                    <a data-toggle="modal" data-target="#modalAutofinancement">
                      <i class="fa fa-question-circle" aria-hidden="true"></i>
                    </a>
                  </th>
                  <th class="text-center">
                    Capacité à rembourser la dette
                    <a data-toggle="modal" data-target="#modalEndettement">
                      <i class="fa fa-question-circle" aria-hidden="true"></i>
                    </a>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center">
                    <% if 100 * (@produits_fonctionnement_2016 + @charges_fonctionnement_2016)/@produits_fonctionnement_2016 <7 %>
                      <%= image_tag "capa_fin_min.png" %>
                    <% elsif 100 * (@produits_fonctionnement_2016 + @charges_fonctionnement_2016)/@produits_fonctionnement_2016 < 10 %>
                      <%= image_tag "capa_fin_small_min.png" %>
                    <% elsif 100 * (@produits_fonctionnement_2016 + @charges_fonctionnement_2016)/@produits_fonctionnement_2016 < 13 %>
                      <%= image_tag "capa_fin_small_max.png" %>
                    <% else %>
                      <%= image_tag "capa_fin_max.png" %>
                    <% end %>
                  </td>
                  <td class="text-center">
                    <% if 100 * @comptes_2016[:endettement_16].to_i / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016) < 0 %>
                      <%= image_tag "capa_fin_max.png" %>
                    <% elsif 100 * @comptes_2016[:endettement_16].to_i / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016) > 1500 %>
                      <%= image_tag "capa_fin_min.png" %>
                    <% elsif 100 * @comptes_2016[:endettement_16].to_i / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016) > 1200 %>
                      <%= image_tag "capa_fin_small_min.png" %>
                    <% elsif 100 * @comptes_2016[:endettement_16].to_i / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016) > 800 %>
                      <%= image_tag "capa_fin_small_max.png" %>
                    <% else %>
                      <%= image_tag "capa_fin_max.png" %>
                    <% end %>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <% end %>
          <p>
            Le budget d'une commune se compose de deux parties :
            <br>
            <br>
            - le <strong>budget de fonctionnement</strong> correspond aux recettes (taxes et impôts locaux, dotation de l'Etat)
            et dépenses (personnel, fournitures...) récurrentes d'une commune,
            <br>
            - le <strong>budget d'investissement</strong> correspond à des dépenses d'équipement et à leur financement (subventions, emprunt).
            <br>
            <br>
            <strong>Le solde du budget de fonctionnement (recettes - dépenses) est appelé épargne brute en comptabilité publique.</strong>
            <br>
            L'épargne brute finance les investissements de la commune. Si elle est insuffisante, la
            commune peut avoir recours à l'emprunt ou demander des subventions à d'autres institutions
            (département, région, Union Européenne)
            <br>
            <br>
            Plusieurs indicateurs permettent d'évaluer la santé financière d'une commune :
            <br>
            <br>
            <strong>1.</strong> La part de l'épargne brute dans le budget de fonctionnement indique la capacité
            de la commune à financer elle-même ses investissements et à faire face à des imprévus.
            A <%= @ville[:nom_propre] %> en 2016 elle était de <%= number_with_precision(100*(@produits_fonctionnement_2016 + @charges_fonctionnement_2016)/@produits_fonctionnement_2016, options = {delimiter: " ", precision: 0}) %>%
            contre 11% en moyenne en France.
            <br>
            <br>
            <strong>2.</strong> Le niveau d'endettement par rapport à l'épargne brute indique la soutenabilité de la
             dette de la commune et donc sa capacité à emprunter à nouveau pour financer ses investissements.
             A <%= @ville[:nom_propre] %> l'endettement représentait <%= number_with_precision(@comptes_2016[:endettement_16].to_i / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016), options = {delimiter: " ", precision: 0}) %>
             fois l'épargne brute annuelle en 2015, contre 7 fois en moyenne en France
            <br>
            <br>
            <strong>3.</strong> L 'évolution de ces ratios permet d'évaluer l'action des élus sur la santé financière de la commune.
            <br>
            <br>
            Pour aller plus loin, une grille d' <%= link_to "analyse des comptes des collectivités locales", pages_notice_analyse_path %> est proposée.
            <br>
            <br>
            <table class="table table-hover">
              <thead>
                <tr>
                  <th></th>
                  <th class="text-center">
                    2011
                  </th>
                  <th class="text-center">
                    2012
                  </th>
                  <th class="text-center">
                    2013
                  </th>
                  <th class="text-center">
                    2014
                  </th>
                  <th class="text-center">
                    2015
                  </th>
                  <th class="text-center">
                    2016
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Recettes réelles de fonctionnement (M€) (1)</th>
                  <td class="text-center">
                    <%= number_with_precision(@produits_fonctionnement_2011/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(@produits_fonctionnement_2012/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(@produits_fonctionnement_2013/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(@produits_fonctionnement_2014/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(@produits_fonctionnement_2015/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(@produits_fonctionnement_2016/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont ressources fiscales (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2011[:impots_locaux_7].to_i+@comptes_2011[:fiscalite_reversee_7].to_i+@comptes_2011[:autres_impots_taxes_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2012[:impots_locaux_7].to_i+@comptes_2012[:fiscalite_reversee_7].to_i+@comptes_2012[:autres_impots_taxes_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2013[:impots_locaux_7].to_i+@comptes_2013[:fiscalite_reversee_7].to_i+@comptes_2013[:autres_impots_taxes_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2014[:impots_locaux_7].to_i+@comptes_2014[:fiscalite_reversee_7].to_i+@comptes_2014[:autres_impots_taxes_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2015[:impots_locaux_7].to_i+@comptes_2015[:fiscalite_reversee_7].to_i+@comptes_2015[:autres_impots_taxes_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <% if @ville[:metropole] == "MGP" %>
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:impots_locaux_7].to_i+@comptes_2016[:fiscalite_reversee_7].to_i+@comptes_2016[:autres_impots_taxes_7].to_i+@comptes_2016[:fonds_compensation_charges_territoriales_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                    <% else %>
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:impots_locaux_7].to_i+@comptes_2016[:fiscalite_reversee_7].to_i+@comptes_2016[:autres_impots_taxes_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                    <% end %>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont dotations et subventions (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2011[:dotations_etat_7].to_i+@comptes_2011[:suventions_participations_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2012[:dotations_etat_7].to_i+@comptes_2012[:suventions_participations_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2013[:dotations_etat_7].to_i+@comptes_2013[:suventions_participations_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2014[:dotations_etat_7].to_i+@comptes_2014[:suventions_participations_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2015[:dotations_etat_7].to_i+@comptes_2015[:suventions_participations_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:dotations_etat_7].to_i+@comptes_2016[:suventions_participations_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont autres recettes courantes (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2011[:ventes_biens_services_7].to_i+@comptes_2011[:autres_produits_fonctionnement_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2012[:ventes_biens_services_7].to_i+@comptes_2012[:autres_produits_fonctionnement_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2013[:ventes_biens_services_7].to_i+@comptes_2013[:autres_produits_fonctionnement_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2014[:ventes_biens_services_7].to_i+@comptes_2014[:autres_produits_fonctionnement_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2015[:ventes_biens_services_7].to_i+@comptes_2015[:autres_produits_fonctionnement_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:ventes_biens_services_7].to_i+@comptes_2016[:autres_produits_fonctionnement_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont recettes exceptionnelles (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2011[:produits_cessions_7].to_i+@comptes_2011[:produits_fonctionnement_exceptionnels_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2012[:produits_cessions_7].to_i+@comptes_2012[:produits_fonctionnement_exceptionnels_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2013[:produits_cessions_7].to_i+@comptes_2013[:produits_fonctionnement_exceptionnels_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2014[:produits_cessions_7].to_i+@comptes_2014[:produits_fonctionnement_exceptionnels_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2015[:produits_cessions_7].to_i+@comptes_2015[:produits_fonctionnement_exceptionnels_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:produits_cessions_7].to_i+@comptes_2016[:produits_fonctionnement_exceptionnels_7].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row">Dépenses réelles de fonctionnement
                  <a data-toggle="modal" data-target="#modalFonctionnement">
                    <i class="fa fa-question-circle" aria-hidden="true"></i>
                  </a>
                   (M€) (2)
                  </th>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_fonctionnement_2011/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_fonctionnement_2012/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_fonctionnement_2013/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_fonctionnement_2014/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_fonctionnement_2015/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_fonctionnement_2016/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont charges de personnel (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2011[:personnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2012[:personnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2013[:personnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2014[:personnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2015[:personnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2016[:personnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont achats et charges externes (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2011[:achats_charges_externes_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2012[:achats_charges_externes_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2013[:achats_charges_externes_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2014[:achats_charges_externes_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2015[:achats_charges_externes_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2016[:achats_charges_externes_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont subventions et interventions (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2011[:subventions_versees_6].to_i-@comptes_2011[:intervention_hors_suventions_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2012[:subventions_versees_6].to_i-@comptes_2012[:intervention_hors_suventions_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2013[:subventions_versees_6].to_i-@comptes_2013[:intervention_hors_suventions_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2014[:subventions_versees_6].to_i-@comptes_2014[:intervention_hors_suventions_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2015[:subventions_versees_6].to_i-@comptes_2015[:intervention_hors_suventions_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <% if @ville[:metropole] == "MGP" %>
                      <i class="subcategory"><%= number_with_precision((-@comptes_2016[:subventions_versees_6].to_i-@comptes_2016[:intervention_hors_suventions_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                    <% else %>
                      <i class="subcategory"><%= number_with_precision((-@comptes_2016[:subventions_versees_6].to_i-@comptes_2016[:intervention_hors_suventions_6].to_i-@comptes_2016[:fonds_compensation_charges_territoriales_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                    <% end %>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont autres dépenses courantes (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2011[:frais_elus_6].to_i-@comptes_2011[:impots_6].to_i-@comptes_2011[:autres_6].to_i-@comptes_2011[:frais_financiers_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2012[:frais_elus_6].to_i-@comptes_2012[:impots_6].to_i-@comptes_2012[:autres_6].to_i-@comptes_2012[:frais_financiers_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2013[:frais_elus_6].to_i-@comptes_2013[:impots_6].to_i-@comptes_2013[:autres_6].to_i-@comptes_2013[:frais_financiers_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2014[:frais_elus_6].to_i-@comptes_2014[:impots_6].to_i-@comptes_2014[:autres_6].to_i-@comptes_2014[:frais_financiers_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2015[:frais_elus_6].to_i-@comptes_2015[:impots_6].to_i-@comptes_2015[:autres_6].to_i-@comptes_2015[:frais_financiers_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2016[:frais_elus_6].to_i-@comptes_2016[:impots_6].to_i-@comptes_2016[:autres_6].to_i-@comptes_2016[:frais_financiers_6].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont charges exceptionnelles (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2011[:exceptionnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2012[:exceptionnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2013[:exceptionnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2014[:exceptionnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2015[:exceptionnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2016[:exceptionnel_6].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row">Epargne brute (M€) (1)-(2)</th>
                  <td class="text-center">
                    <%= number_with_precision((@produits_fonctionnement_2011 + @charges_fonctionnement_2011)/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@produits_fonctionnement_2012 + @charges_fonctionnement_2012)/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@produits_fonctionnement_2013 + @charges_fonctionnement_2013)/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@produits_fonctionnement_2014 + @charges_fonctionnement_2014)/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@produits_fonctionnement_2015 + @charges_fonctionnement_2015)/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@produits_fonctionnement_2016 + @charges_fonctionnement_2016)/1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row" class="category">Epargne brute / recettes réelles</th>
                  <td class="text-center category">
                    <%= number_with_precision(100*(@produits_fonctionnement_2011 + @charges_fonctionnement_2011)/@produits_fonctionnement_2011, options = {delimiter: " ", precision: 0}) %>%
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(100*(@produits_fonctionnement_2012 + @charges_fonctionnement_2012)/@produits_fonctionnement_2012, options = {delimiter: " ", precision: 0}) %>%
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(100*(@produits_fonctionnement_2013 + @charges_fonctionnement_2013)/@produits_fonctionnement_2013, options = {delimiter: " ", precision: 0}) %>%
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(100*(@produits_fonctionnement_2014 + @charges_fonctionnement_2014)/@produits_fonctionnement_2014, options = {delimiter: " ", precision: 0}) %>%
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(100*(@produits_fonctionnement_2015 + @charges_fonctionnement_2015)/@produits_fonctionnement_2015, options = {delimiter: " ", precision: 0}) %>%
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(100*(@produits_fonctionnement_2016 + @charges_fonctionnement_2016)/@produits_fonctionnement_2016, options = {delimiter: " ", precision: 0}) %>%
                  </td>
                </tr>
                <tr>
                  <th scope="row">Recettes réelles d'équipement
                  <a data-toggle="modal" data-target="">
                    <i class="fa fa-question-circle" aria-hidden="true"></i>
                  </a>
                   (M€)
                  </th>
                  <td class="text-center">
                    <%= number_with_precision((+@comptes_2011[:fctva_1].to_i+@comptes_2011[:subventions_equipement_recues_1].to_i+@comptes_2011[:autres_recettes_equipement_2].to_i+@comptes_2011[:autres_dotations_subventions_equipement_1].to_i+@comptes_2011[:recettes_operations_tiers_4].to_i) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text+center">
                    <%= number_with_precision((+@comptes_2012[:fctva_1].to_i+@comptes_2012[:subventions_equipement_recues_1].to_i+@comptes_2012[:autres_recettes_equipement_2].to_i+@comptes_2012[:autres_dotations_subventions_equipement_1].to_i+@comptes_2012[:recettes_operations_tiers_4].to_i) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text+center">
                    <%= number_with_precision((+@comptes_2013[:fctva_1].to_i+@comptes_2013[:subventions_equipement_recues_1].to_i+@comptes_2013[:autres_recettes_equipement_2].to_i+@comptes_2013[:autres_dotations_subventions_equipement_1].to_i+@comptes_2013[:recettes_operations_tiers_4].to_i) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text+center">
                    <%= number_with_precision((+@comptes_2014[:fctva_1].to_i+@comptes_2014[:subventions_equipement_recues_1].to_i+@comptes_2014[:autres_recettes_equipement_2].to_i+@comptes_2014[:autres_dotations_subventions_equipement_1].to_i+@comptes_2014[:recettes_operations_tiers_4].to_i) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text+center">
                    <%= number_with_precision((+@comptes_2015[:fctva_1].to_i+@comptes_2015[:subventions_equipement_recues_1].to_i+@comptes_2015[:autres_recettes_equipement_2].to_i+@comptes_2015[:autres_dotations_subventions_equipement_1].to_i+@comptes_2015[:recettes_operations_tiers_4].to_i) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text+center">
                    <%= number_with_precision((+@comptes_2016[:fctva_1].to_i+@comptes_2016[:subventions_equipement_recues_1].to_i+@comptes_2016[:autres_recettes_equipement_2].to_i+@comptes_2016[:autres_dotations_subventions_equipement_1].to_i+@comptes_2016[:recettes_operations_tiers_4].to_i) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont subventions et FCTVA (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2011[:fctva_1].to_i+@comptes_2011[:subventions_equipement_recues_1].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2012[:fctva_1].to_i+@comptes_2012[:subventions_equipement_recues_1].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2013[:fctva_1].to_i+@comptes_2013[:subventions_equipement_recues_1].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2014[:fctva_1].to_i+@comptes_2014[:subventions_equipement_recues_1].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2015[:fctva_1].to_i+@comptes_2015[:subventions_equipement_recues_1].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:fctva_1].to_i+@comptes_2016[:subventions_equipement_recues_1].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont autres recettes d'équipement (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2011[:autres_recettes_equipement_2].to_i+@comptes_2011[:autres_dotations_subventions_equipement_1].to_i+@comptes_2011[:recettes_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2012[:autres_recettes_equipement_2].to_i+@comptes_2012[:autres_dotations_subventions_equipement_1].to_i+@comptes_2012[:recettes_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2013[:autres_recettes_equipement_2].to_i+@comptes_2013[:autres_dotations_subventions_equipement_1].to_i+@comptes_2013[:recettes_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2014[:autres_recettes_equipement_2].to_i+@comptes_2014[:autres_dotations_subventions_equipement_1].to_i+@comptes_2014[:recettes_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2015[:autres_recettes_equipement_2].to_i+@comptes_2015[:autres_dotations_subventions_equipement_1].to_i+@comptes_2015[:recettes_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((@comptes_2016[:autres_recettes_equipement_2].to_i+@comptes_2016[:autres_dotations_subventions_equipement_1].to_i+@comptes_2016[:recettes_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row">Dépenses réelles d'équipement
                  <a data-toggle="modal" data-target="#modalEquipement">
                    <i class="fa fa-question-circle" aria-hidden="true"></i>
                  </a>
                   (M€)
                  </th>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_investissement_2011 / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_investissement_2012 / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_investissement_2013 / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_investissement_2014 / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_investissement_2015 / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision(-@charges_investissement_2016 / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont investissements (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2011[:depenses_equipement_2].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2012[:depenses_equipement_2].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2013[:depenses_equipement_2].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2014[:depenses_equipement_2].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2015[:depenses_equipement_2].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision(-@comptes_2016[:depenses_equipement_2].to_i/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row"><i class="subcategory">Dont autres (M€)</i></th>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2011[:subventions_equipement_versees_2].to_i-@comptes_2011[:autres_depenses_equipement_2].to_i-@comptes_2011[:autres_depenses_equipement_1].to_i-@comptes_2011[:depenses_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2012[:subventions_equipement_versees_2].to_i-@comptes_2012[:autres_depenses_equipement_2].to_i-@comptes_2012[:autres_depenses_equipement_1].to_i-@comptes_2012[:depenses_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2013[:subventions_equipement_versees_2].to_i-@comptes_2013[:autres_depenses_equipement_2].to_i-@comptes_2013[:autres_depenses_equipement_1].to_i-@comptes_2013[:depenses_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2014[:subventions_equipement_versees_2].to_i-@comptes_2014[:autres_depenses_equipement_2].to_i-@comptes_2014[:autres_depenses_equipement_1].to_i-@comptes_2014[:depenses_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2015[:subventions_equipement_versees_2].to_i-@comptes_2015[:autres_depenses_equipement_2].to_i-@comptes_2015[:autres_depenses_equipement_1].to_i-@comptes_2015[:depenses_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                  <td class="text-center">
                    <i class="subcategory"><%= number_with_precision((-@comptes_2016[:subventions_equipement_versees_2].to_i-@comptes_2016[:autres_depenses_equipement_2].to_i-@comptes_2016[:autres_depenses_equipement_1].to_i-@comptes_2016[:depenses_operations_tiers_4].to_i)/1000000.0, options = {delimiter: " ", precision: 1}) %></i>
                  </td>
                </tr>
                <tr>
                  <th scope="row">Endettement (M€) </th>
                  <td class="text-center">
                    <%= number_with_precision((@comptes_2011[:endettement_16]) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@comptes_2012[:endettement_16]) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@comptes_2013[:endettement_16]) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@comptes_2014[:endettement_16]) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@comptes_2015[:endettement_16]) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                  <td class="text-center">
                    <%= number_with_precision((@comptes_2016[:endettement_16]) / 1000000.0, options = {delimiter: " ", precision: 1}) %>
                  </td>
                </tr>
                <tr>
                  <th scope="row" class="category">Endettement / épargne brute</th>
                  <td class="text-center category">
                    <% if @comptes_2011[:endettement_16] / (@produits_fonctionnement_2011 + @charges_fonctionnement_2011) < 0 %>
                    ns
                    <% elsif @comptes_2011[:endettement_16] / (@produits_fonctionnement_2011 + @charges_fonctionnement_2011) >=50 %>
                    ns
                    <% else %>
                    <%= number_with_precision(@comptes_2011[:endettement_16] / (@produits_fonctionnement_2011 + @charges_fonctionnement_2011), options = {delimiter: " ", precision: 0}) %>x
                    <% end %>
                  </td>
                  <td class="text-center category">
                    <% if @comptes_2012[:endettement_16] / (@produits_fonctionnement_2012 + @charges_fonctionnement_2012) < 0 %>
                    ns
                    <% elsif @comptes_2012[:endettement_16] / (@produits_fonctionnement_2012 + @charges_fonctionnement_2012) >=50 %>
                    ns
                    <% else %>
                    <%= number_with_precision(@comptes_2012[:endettement_16] / (@produits_fonctionnement_2012 + @charges_fonctionnement_2012), options = {delimiter: " ", precision: 0}) %>x
                    <% end %>
                  </td>
                  <td class="text-center category">
                    <% if @comptes_2013[:endettement_16] / (@produits_fonctionnement_2013 + @charges_fonctionnement_2013) < 0 %>
                    ns
                    <% elsif @comptes_2013[:endettement_16] / (@produits_fonctionnement_2013 + @charges_fonctionnement_2013) >=50 %>
                    ns
                    <% else %>
                    <%= number_with_precision(@comptes_2013[:endettement_16] / (@produits_fonctionnement_2013 + @charges_fonctionnement_2013), options = {delimiter: " ", precision: 0}) %>x
                    <% end %>
                  </td>
                  <td class="text-center category">
                    <% if @comptes_2014[:endettement_16] / (@produits_fonctionnement_2014 + @charges_fonctionnement_2014) < 0 %>
                    ns
                    <% elsif @comptes_2014[:endettement_16] / (@produits_fonctionnement_2014 + @charges_fonctionnement_2014) >=50 %>
                    ns
                    <% else %>
                    <%= number_with_precision(@comptes_2014[:endettement_16] / (@produits_fonctionnement_2014 + @charges_fonctionnement_2014), options = {delimiter: " ", precision: 0}) %>x
                    <% end %>
                  </td>
                  <td class="text-center category">
                    <% if @comptes_2015[:endettement_16] / (@produits_fonctionnement_2015 + @charges_fonctionnement_2015) < 0 %>
                    ns
                    <% elsif @comptes_2015[:endettement_16] / (@produits_fonctionnement_2015 + @charges_fonctionnement_2015) >=50 %>
                    ns
                    <% else %>
                    <%= number_with_precision(@comptes_2015[:endettement_16] / (@produits_fonctionnement_2015 + @charges_fonctionnement_2015), options = {delimiter: " ", precision: 0}) %>x
                    <% end %>
                  </td>
                  <td class="text-center category">
                    <% if @comptes_2016[:endettement_16] / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016) < 0 %>
                    ns
                    <% elsif @comptes_2016[:endettement_16] / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016) >=50 %>
                    ns
                    <% else %>
                    <%= number_with_precision(@comptes_2016[:endettement_16] / (@produits_fonctionnement_2016 + @charges_fonctionnement_2016), options = {delimiter: " ", precision: 0}) %>x
                    <% end %>
                  </td>
                </tr>
                <tr>
                  <th scope="row" class="category">Endettement / habitant</th>
                  <td class="text-center category">
                    <%= number_with_precision(@comptes_2011[:endettement_16] / (@comptes_2011[:population]), options = {delimiter: " ", precision: 0}) %>€
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(@comptes_2012[:endettement_16] / (@comptes_2012[:population]), options = {delimiter: " ", precision: 0}) %>€
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(@comptes_2013[:endettement_16] / (@comptes_2013[:population]), options = {delimiter: " ", precision: 0}) %>€
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(@comptes_2014[:endettement_16] / (@comptes_2014[:population]), options = {delimiter: " ", precision: 0}) %>€
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(@comptes_2015[:endettement_16] / (@comptes_2015[:population]), options = {delimiter: " ", precision: 0}) %>€
                  </td>
                  <td class="text-center category">
                    <%= number_with_precision(@comptes_2016[:endettement_16] / (@comptes_2016[:population]), options = {delimiter: " ", precision: 0}) %>€
                  </td>
                </tr>
              </tbody>
            </table>
          </p>
          <p>
            Pour bien appréhender l’évolution des finances de votre commune, il faut être
            attentif aux tendances dans le temps. Un taux d’épargne brute qui se dégrade
            sous 10% doit poser question :
            <br>
            - pourquoi les recettes ou les dépenses de la commune diminuent-elles ?
            <br>
            - comment va-t-elle pouvoir retrouver une épargne brute qui lui permette de
            financer des investissements ? La fiscalité doit elle être augmentée ou les
            dépenses rationalisées ?
            <br>
            De même une épargne brute excessive peut révéler un niveau d’imposition trop
            important par rapport aux services rendus.
            <br>
            <br>
            L’endettement doit être maîtrisé et, d’une manière générale, ne jamais dépasser
            15 fois l’épargne brute puisque la durée moyenne d’un emprunt est de 15 ans.
            Cependant, un endettement très faible ou nul dans une ville de plus de 5 000
            habitants est généralement le signe d’un sous-investissement et d’une imposition
            trop élevée par rapport aux équipements disponibles. En effet, à la différence
            d’un ménage, une commune n’épargne généralement pas, ses investissements sont
            financés par des emprunts qui sont remboursés par son épargne brute.
          </p>
          <br>
          <br>
          <p class="text-center">
            <%= image_tag "end_text_symbol.png" %>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Capacité d'autofinancement -->
<div class="modal fade" id="modalAutofinancement" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"><strong>Le capacité d'autofinancement</strong></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <p>
        La capacité d'autofinancement est la capacité de la collectivité à financer des investissements
        par des ressources propres plutôt que par l'emprunt ou des subventions d'autres instances publiques.
        <br>
        <br>
        Le budget d'une commune se compose de deux parties :
        <br>
        - le <strong>budget de fonctionnement</strong> correspond aux recettes (taxes et impôts locaux, dotation de l'Etat)
        et dépenses (personnel, fournitures...) récurrentes d'une commune,
        <br>
        - le <strong>budget d'investissement</strong> correspond à des dépenses d'équipement et à leur financement (subventions, emprunt). 
        <br>
        <br>
        <strong>Le solde du budget de fonctionnement (recettes - dépenses) est appelé épargne brute en comptabilité publique.</strong>
        <br>
        <br>
        La capacité d'autofinancement d'une commune est ici mesurée par le ratio: Epargne brute / Recette de fonctionnement.
        Plus ce ratio est élevé, plus la commune dégage par son fonctionnement un excédent capable de financer
        ses investissements.
        <br>
        En France en 2015, ce ratio était de 11% en moyenne.
      </p>
      </div>
      <div class="modal-footer">
        <p>
        Sources : Cahier INET "Déchiffrer les Comptes des Collectivités Locales", données collectivites-locales.gouv.fr
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Capacité à rembourser la dette -->
<div class="modal fade" id="modalEndettement" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"><strong>La capacité à rembourser la dette</strong></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <p>
        La capacité à rembourser la dette d'une commune est une information clé :
        une commune qui est en voie de surendettement devra en effet consacrer des sommes
        importantes au remboursement du capital de l'emprunt ce qui grèvera sa capacité
        d'investissement et payer d'importants frais financiers ce qui impactera son budget de fonctionnement.
        <br>
        Elle détermine d'autre part le risque que prend l'investisseur en accordant un nouveau prêt à la collectivité,
        et donc le taux d'intérêt qui va être appliqué.
        <br>
        <br>
        On peut la mesurer par le ratio: Encours de dette / Epargne brute qui mesure le nombre d'années
        théorique que la collectivité mettrait à rembourser la dette contractée au niveau actuel d'excédent de fonctionnement.
        <br>
        <br>
        En France en 2015, ce ratio était de 7x en moyenne.
      </p>
      </div>
      <div class="modal-footer">
        <p>
        Sources : Cahier INET "Déchiffrer les Comptes des Collectivités Locales", données collectivites-locales.gouv.fr
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Dépenses de fonctionnement -->
<div class="modal fade" id="modalFonctionnement" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"><strong>Les dépenses de fonctionnement</strong></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <p>
        Les dépenses de fonctionnement correspondent aux dépenses récurrentes de la commune.
        <br>
        <br>
        Ces dépenses représentaient en 2016 pour les collectivités locales 169 milliards d'euros, soit 79% du total des dépenses.
        <br>
        <br>
        Les principaux types de dépenses de fonctionnement sont les suivantes:
        <br>
        - Charges de personnel : 61 milliards d'euros en 2016 soit 36% des dépenses de fonctionnement
        <br>
        - Dépenses d'intervention liées directement à l'action de la collectivité locale
        (voir notre <%= link_to "notice sur les compétences", pages_notice_competences_path %>):
        68 milliards d'euros en 2015 soit 40% des dépenses de fonctionnement
        <br>
        - Achats et charges externes telles que les fournitures, mobilier, électricité, téléphonie,
        prestations de services diverses : 30 milliards d'euros en 2016, soit 18% des dépenses de fonctionnement
        <br>
        - Intérêts de la dette : environ 3% des dépenses de fonctionnement
      </p>
      </div>
      <div class="modal-footer">
        <p>
        Source : collectivites-locales.gouv.fr, Fipeco
        </p>
      </div>
    </div>
  </div>
</div>


<!-- Dépenses d'équipement' -->
<div class="modal fade" id="modalEquipement" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"><strong>Les dépenses d'équipement</strong></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <p>
        Les dépenses d'investissement ou d'équipement modifient la valeur du patrimoine de la collectivité :
        <br>
        - Travaux d'équipement, d'infrastructures, construction ou rénovation de bâtiments
        <br>
        - Acquisition de valeurs mobilières ou immobilières
        <br>
        - Achats de produits "durables" (parc automobile, …)
        <br>
        - Subventions d'investissement versées à des acteurs locaux
        <br>
        <br>
        Ces dépenses d'investissement ont représenté en 2015 51 milliards d'euros soit 23% des dépenses totales
        <br>
        59% de l'effort d'investissement est effectué au niveau de la commune et des communautés de commune,
        contre 22% pour les départements et 19% pour les régions.
        <br>
        <br>
        Pour plus d'information sur la structure des budgets, vous pouvez consulter
        notre <%= link_to "notice dédiée", pages_notice_analyse_path %>)
        <br>
        Pour plus d'information sur la comptabilité des communes, vous pouvez consulter
        notre <%= link_to "notice méthodologique", pages_notice_methodologie_path %>)
      </p>
      </div>
      <div class="modal-footer">
        <p>
        Source : collectivites-locales.gouv.fr, Fipeco
        </p>
      </div>
    </div>
  </div>
</div>


